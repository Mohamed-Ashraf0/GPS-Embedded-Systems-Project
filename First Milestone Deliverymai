#include "GPS.h"
#include "TM4C123.h"
#include "UART.h"
#include "SYSTICK.h"
#include "Bit_Utilies.h"
#include "DIO.h"
#include <float.h>
#include "GPIO_FOE_LCD.h"
#include "LCD.h"
#include <string.h>

extern char Valid ;
extern char Lat[15];
extern char NorS;
extern char longi[15];
extern char EorW;
extern double currentLong ,currentLat ,speed ;
double PreviousLong , PrivousLat;
double Distance = 0 , totalDistance =0; 
 char check[]="unreached";
 char finish[]="reached";
void SystemInit(){}
unsigned char Total_distance_message[]="  total distance im meter  ";
unsigned char long_message[];
unsigned char lati_message[];
unsigned char message[20] ;


int main(){
	GPIO_initPortA();
	GPIO_initPortB();
	GPIO_initPortD();
	GPIO_initPortE();
	SysTick_Wait1ms(500);	
	LCD_Init ();
	int flag1=0;
	GPIOF_Init();		
	UART2_init(); 
	while(totalDistance<100){
	GPS_read ();
	PreviousLong=currentLat;
 	PrivousLat=currentLat;
   if(flag1){
  Distance=GPS_getDistance( currentLat,currentLong,PrivousLat, PreviousLong);
  totalDistance+=Distance;
  sprintf(message, "%f", totalDistance); /*converting the total distance from double to string */
  /*if the switch is not pressed display statment 1 else statment 2*/
 if (GETBIT(GPIO_PORTF_DATA_R,0)){
  LCD_String_First_line( Total_distance_message, sizeof (Total_distance)-1);
  LCD_String_Second_line(message ,sizeof(message)-1 );
 }
 else if (GETBIT(GPIO_PORTF_DATA_R,0)==0){
  long_message = " longitude in meter "+ longi;
  lati_message = " latitude im meter " +lat;
  LCD_String_First_line( long_message , sizeof (long_message)-1);
  LCD_String_Second_line( lati_message ,sizeof(lati_message)-1 );
  }
	 flag1=1;
   }
	strcpy(check,finish);
	   greenon();	
	 while(1);
	}
 }
